<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пустошь: Выживание</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button id="burger-menu-button">☰</button>

    <div id="game-wrapper">
        <aside id="sidebar">
            <div id="sidebar-header">
                <h2>Пустошь</h2>
                <button id="inventory-button" class="sidebar-button">Инвентарь Игрока</button>
            </div>
            <nav id="main-nav">
                <button class="nav-link active" data-tab="main-tab">Обзор</button>
                <button class="nav-link" data-tab="base-tab">База</button>
                <button class="nav-link" data-tab="storage-tab">Склад</button>
                <button class="nav-link" data-tab="explore-tab">Разведка</button>
                <button class="nav-link" data-tab="craft-tab">Крафт</button>
            </nav>
            <div id="player-status-condensed" class="panel">
                <h4>Состояние Игрока</h4>
                <p>День: <span id="day">1</span></p>
                <div class="status-bar-container">
                    <span class="status-label">Здоровье:</span>
                    <div class="progress-bar-outer" id="health-bar-outer">
                        <div class="progress-bar-inner" id="health-bar-inner"></div>
                        <span class="progress-bar-text" id="health-bar-text">100/100</span>
                    </div>
                </div>
                <div class="status-bar-container">
                    <span class="status-label">Сытость:</span>
                    <div class="progress-bar-outer" id="hunger-bar-outer">
                        <div class="progress-bar-inner" id="hunger-bar-inner"></div>
                        <span class="progress-bar-text" id="hunger-bar-text">Норма</span>
                    </div>
                </div>
                <div class="status-bar-container">
                     <span class="status-label">Жажда:</span>
                    <div class="progress-bar-outer" id="thirst-bar-outer">
                        <div class="progress-bar-inner" id="thirst-bar-inner"></div>
                        <span class="progress-bar-text" id="thirst-bar-text">Норма</span>
                    </div>
                </div>
                <p style="margin-top: 10px;">Выжившие: <span id="survivors">1</span> / <span id="max-survivors">1</span></p>
            </div>
             <div id="quick-stats" class="panel">
                <h4>Ресурсы Базы (Склад)</h4>
                <p>Еда (сытость): <span id="total-food-value">0</span></p>
                <p>Вода (жажда): <span id="total-water-value">0</span></p>
            </div>
        </aside>

        <main id="main-content">
            <header id="main-header">
                <h1>Выживание в Пустоши</h1>
                <div id="player-condition-display">Состояние игрока: <span id="player-condition">В порядке</span></div>
            </header>

            <div id="tab-content-area">
                <!-- Вкладка Обзор -->
                <div id="main-tab" class="tab-content" style="display: block;">
                    <h2>Обзор и События</h2>
                    <div class="overview-stats-container">
                        <div class="overview-panel">
                            <h3>Статус Игрока</h3>
                            <p>Здоровье: <span id="overview-health">100/100</span></p>
                            <p>Сытость: <span id="overview-hunger">Норма</span></p>
                            <p>Жажда: <span id="overview-thirst">Норма</span></p>
                            <p>Состояние: <span id="overview-condition">В порядке</span></p>
                        </div>
                        <div class="overview-panel">
                            <h3>Статус Базы</h3>
                            <p>День: <span id="overview-day">1</span></p>
                            <p>Выжившие: <span id="overview-survivors">1/1</span></p>
                            <p>Еда на складе (сытость): <span id="overview-base-food">0</span></p>
                            <p>Вода на складе (жажда): <span id="overview-base-water">0</span></p>
                        </div>
                    </div>
                    <div class="action-group">
                        <h3>Действия Дня</h3>
                        <button id="next-day-button" class="game-action-button" onclick="game.nextDay()">Завершить день</button>
                    </div>
                    <div id="event-actions-container" class="action-group" style="display: none;">
                        <h3>Текущее Событие</h3>
                        <div id="event-text-display"></div>
                        <div id="event-actions"></div>
                    </div>
                </div>

                <!-- Вкладка База -->
                <div id="base-tab" class="tab-content">
                    <h2>Управление Базой</h2>
                    <div id="build-actions" class="action-grid"></div>
                </div>

                <!-- Вкладка Склад -->
                <div id="storage-tab" class="tab-content">
                    <h2>Склад Базы</h2>
                    <div class="inventory-filters base-storage-filters">
                        <button data-filter="all" class="active">Все</button>
                        <button data-filter="food">Еда</button>
                        <button data-filter="water_source">Вода</button>
                        <button data-filter="medicine">Медикаменты</button>
                        <button data-filter="material">Материалы</button>
                        <button data-filter="tool">Инструменты</button>
                        <button data-filter="weapon">Оружие</button>
                        <button data-filter="armor">Броня</button>
                        <button data-filter="quest_item">Особое</button>
                    </div>
                    <div id="base-inventory-list" class="inventory-list-shared-style"></div>
                </div>

                <!-- Вкладка Разведка -->
                <div id="explore-tab" class="tab-content">
                    <h2>Разведка Местности</h2>
                    <div class="action-group">
                        <h3>Действия на текущей локации: <span id="current-location-name">Окрестности Базы</span></h3>
                        <button id="scout-current-location-button" class="game-action-button" onclick="LocationManager.exploreCurrentLocationAction('search')">Обыскать (<span id="current-location-time">1</span> д.)</button>
                        <p id="current-location-description">Это ваша база и ближайшие окрестности.</p>
                    </div>
                    <div class="action-group">
                        <h3>Известные Локации</h3>
                        <div id="discovered-locations-list">
                            <p><em>Используйте "Разведать новые территории", чтобы найти новые места.</em></p>
                        </div>
                         <button id="discover-new-location-button" class="game-action-button" onclick="LocationManager.discoverNewLocationAction()">Разведать новые территории (1 д.)</button>
                    </div>
                </div>

                <!-- Вкладка Крафт -->
                <div id="craft-tab" class="tab-content">
                    <h2>Изготовление Предметов</h2>
                    <p>Мастерская Ур: <span id="workshop-level-display">0</span></p>
                    <div id="crafting-recipes-list" class="crafting-grid">
                        <p><em>Рецепты не найдены или не выполнены условия.</em></p>
                    </div>
                </div>
            </div>

            <!-- Панель лога -->
            <div id="log-panel-container">
                 <div id="log-panel" class="panel">
                    <div class="log-header">
                        <h2>Журнал Событий</h2>
                        <button id="toggle-log" title="Скрыть/Показать лог">-</button>
                    </div>
                    <div id="log-messages">
                        <p>Добро пожаловать в Пустошь.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Модальное окно инвентаря игрока -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="InventoryManager.closeInventoryModal()">×</span>
            <h2>Инвентарь Игрока (<span id="inventory-weight">0</span> / <span id="inventory-max-weight">25</span> кг)</h2>
            <div class="inventory-filters player-inventory-filters">
                <button data-filter="all" class="active">Все</button>
                <button data-filter="food">Еда</button>
                <button data-filter="water_source">Вода</button>
                <button data-filter="medicine">Медикаменты</button>
                <button data-filter="material">Материалы</button>
                <button data-filter="tool">Инструменты</button>
                <button data-filter="weapon">Оружие</button>
                <button data-filter="armor">Броня</button>
                <button data-filter="quest_item">Особое</button>
            </div>
            <div id="inventory-items-list" class="inventory-list-shared-style"></div>
        </div>
    </div>

    <!-- НОВОЕ: Модальное окно информации о локации -->
    <div id="location-info-modal" class="modal" style="display: none;">
        <div class="modal-content location-modal-content"> <!-- Добавлен класс location-modal-content для специфичных стилей, если понадобятся -->
            <span id="location-info-close-button" class="close-button" onclick="UIManager.closeLocationInfoModal()">×</span>
            <h2 id="location-info-name">Название Локации</h2>
            <p id="location-info-description">Описание локации здесь...</p>
            <p><strong>Уровень опасности:</strong> <span id="location-info-danger">Средний</span></p>
            <div id="location-info-preview-loot" class="location-info-section">
                <!-- <strong>Возможная добыча:</strong> Информация о добыче скрыта... -->
            </div>
            <div class="modal-actions"> <!-- Контейнер для кнопок в модалке -->
                <button id="location-info-travel-button" class="game-action-button">Перейти сюда</button>
            </div>
        </div>
    </div>


    <footer>
        <button onclick="game.resetGameConfirmation()">Начать игру заново</button>
        <p id="game-version">Версия: 0.0.0</p>
    </footer>

    <!-- Файлы определений -->
    <script src="items.js"></script>
    <script src="buildings.js"></script>
    <script src="locations.js"></script> <!-- Убедись, что здесь есть previewLootText -->
    <script src="recipes.js"></script>

    <!-- Файлы состояния и DOM -->
    <script src="game_state.js"></script>
    <script src="dom_elements.js"></script> <!-- Должен быть загружен до менеджеров -->

    <!-- Файлы менеджеров (ПОРЯДОК ВАЖЕН!) -->
    <script src="ui_manager.js"></script>
    <script src="inventory_manager.js"></script>
    <script src="location_manager.js"></script>
    <script src="event_manager.js"></script>

    <!-- Основной файл игры (ПОСЛЕДНИМ) -->
    <script src="script.js"></script>
</body>
</html>
